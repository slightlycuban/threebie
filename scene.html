<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <title>THREE.js</title>
    <script src='js/jquery.min.js'></script>
    <script src='js/three.min.js'></script>
    <script src="js/Detector.js"></script>
  </head>
  <body>
    <div id='container'></div>
  </body>
  <script>
    var $container = $('#container');
    var renderer;
    var camera;
    var scene;

    function animate() {
      requestAnimationFrame(animate);
      drawScene();
    }
    
    var drawScene = function() {
      camera.lookAt(scene.position);

      var timer = new Date().getTime() * 0.0005;
      camera.position.x = Math.floor(Math.cos(timer) * 200);
      camera.position.z = Math.floor(Math.sin(timer) * 200);

      renderer.render(scene, camera);
    }
    
    function init() {
      if (Detector.webgl) {
        renderer = new THREE.WebGLRenderer();
      } else {
        renderer = new THREE.CanvasRenderer();
      }

      var WIDTH = 400, HEIGHT = 300;
      var VIEW_ANGLE = 45, ASPECT = WIDTH / HEIGHT, NEAR = 0.1, FAR = 10000;

      camera = new THREE.PerspectiveCamera(VIEW_ANGLE, ASPECT, NEAR, FAR);
      scene = new THREE.Scene();
    
      camera.position.z = 300;

      renderer.setSize(WIDTH, HEIGHT);

      $container.append(renderer.domElement);

      var sphereMaterial = new THREE.MeshLambertMaterial({
        color: 0xCC0000
      });

      var radius = 50, segments = 16, rings = 16;

      var sphere = new THREE.Mesh(
          new THREE.SphereGeometry(radius, segments, rings),
          sphereMaterial);

      var pointLight = new THREE.PointLight( 0xFFFFFF );

      pointLight.position.x = 10;
      pointLight.position.y = 50;
      pointLight.position.x = 130;

      scene.add(pointLight);

      scene.add(sphere);

      var imagePrefix = "img/dawnmountain-";
      var directions  = ["xpos", "xneg", "ypos", "yneg", "zpos", "zneg"];
      var imageSuffix = ".png";

      var materialArray = [];
      for (var i = 0; i < 6; i++) {
        materialArray.push( new THREE.MeshBasicMaterial({
          map: THREE.ImageUtils.loadTexture( imagePrefix + directions[i] + imageSuffix ),
          side: THREE.BackSide }));
      }
      var skyMaterial = new THREE.MeshFaceMaterial( materialArray );

      var skybox = new THREE.Mesh(
          new THREE.CubeGeometry(500,500,500),
          skyMaterial
          );
      skybox.flipSided = true;
      scene.add(skybox);
    }
    
    init();
    animate();
  </script>
</html>
